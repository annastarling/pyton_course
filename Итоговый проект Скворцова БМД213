# Создается переменная для инвентаря, пишется функция для вывода
# его содержимого. Создается множество для записи туда открытых концовок
# и функция для сбора, распаковки и вывода списка открытых концовок.
# Создается переменная, хранящая в себе текст правил.
# Все функции однотипны, поэтому распишу работу двух вариантов: для
# действия и для концовки.

# Функция действия печатает текст, затем принимает ввод, после чего
# запускается цикл while True. Выход из цикла происходит после введения
# определенного значения для перехода к следующей функции.
# При введении "инвентарь" и "правила" выводятся инвентарь и правила
# соответственно, это происходит внутри цикла. Некорректные значения
# вызывают соответствующее сообщение. При наличии вариантов действий
# происходит вызов функции, соответствующей выбранному варианту.
# Добавление/удаление элементов инвентаря происходит
# вне цикла while True, до или после, внутри if/elif/else.

# Функция концовки аналогична функции действия, но после вывода текста
# не принимается ввод, а определяется количество открытых концовок.
# В зависимости от того, открыты все концовки или нет, реализуется
# один из двух циклов while True, при выходе из которых начинается новая
# попытка или новая игра. В случае новой игры очищается список концовок,
# в обоих случаях очищается инвентарь. Внутри цикла можно увидеть список
# открытых концовок.


inventory = []


def inv():
    if inventory == []:
        print("\nИНВЕНТАРЬ: \n\nВаш инвентарь пуст.")
    else:
        print(f"\nИНВЕНТАРЬ:\n\n{', '.join(inventory)}")


endings = set()


def all_end():
    print("\nОТКРЫТЫЕ КОНЦОВКИ:\n")
    ae = sorted(endings)
    print(*ae, sep="\n")


rules = "\nПРАВИЛА: \
\n\nНа каждом шаге игра будет предлагать вам \
совершить действие, \
\nдоступные варианты будут указаны в скобках <>.\
\nВведите соответствующую необходимому действию букву \
КИРИЛЛИЦЫ в поле ввода и \
нажмите «Enter». \nДля того, чтобы вызвать правила, введите «ПРАВИЛА» \
(любой регистр). \
\nЧтобы показать инвентарь, введите «ИНВЕНТАРЬ» \
(любой регистр). \
\nВ некоторых случаях вам может понадобиться ввести \
несколько цифр/букв КИРИЛЛИЦЕЙ. \
\nПосле ввода допустимого варианта вернуться к выбору будет невозможно! \
\nКаждое ваше решение повлияет на развитие событий."


def collect_all():
    print("\n\nПоздравляю! Вы открыли все возможные концовки!\
\n<НАЧАТЬ СОБИРАТЬ КОНЦОВКИ ЗАНОВО: А> <СПИСОК ОТКРЫТЫХ КОНЦОВОК: К>")
    restart_fin = input().strip().upper()
    while True:
        if restart_fin == "А":
            break
        elif restart_fin == "К":
            all_end()
            restart_fin = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            restart_fin = input().strip().upper()
    endings.clear()
    start_new_game()


def not_collect_all():
    print("\nВыбирая другие комбинации \
действий по ходу игры, вы сможете открыть остальные!\
\nСыграть снова?\
\n\n<НОВАЯ ПОПЫТКА: А> <СПИСОК ОТКРЫТЫХ КОНЦОВОК: К>")
    restart = input().strip().upper()
    while True:
        if restart == "А":
            break
        elif restart == "К":
            all_end()
            restart = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            restart = input().strip().upper()
    print("\n\nЮРЭЙ\n\n\nТекстовая хоррор-игра\n\nАвтор: \
Скворцова Анна\n\n")
    start_text()


def start_new_game():
    print(f"\n\nЮРЭЙ\n\n\nТекстовая хоррор-игра\n\nАвтор: \
Скворцова Анна\n\n{rules}\n\n<НАЧАТЬ ИГРУ: А>")
    in_start_game = input().strip().upper()
    while True:
        if in_start_game == "А":
            break
        elif in_start_game == "ИНВЕНТАРЬ":
            inv()
            in_start_game = input().strip().upper()
        elif in_start_game == "ПРАВИЛА":
            print(rules)
            in_start_game = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            in_start_game = input().strip().upper()
    start_text()


def start_text():
    print('\n«Экономическая специализация регионов… \
\nважнейшую роль в развитии… концом эры Мэйдзи…» \
\n\nКонец июля. Невероятная духота. Сидя за партой, вы \
отчаянно силитесь держать глаза открытыми. \
\nЗа окном дрожит горячий воздух. \
\nВчера вы допоздна засиделись у Исаму, соревнуясь в новой видеоигре. \
\nЭто было плохой идеей, но тогда вы об этом не подумали. \
\nСпать хотелось настолько, что даже на неизбежный выговор \
\nза просроченную домашку было наплевать. \
\nБуквы на странице учебника блекнут и размазываются. \
\nДо конца урока еще полчаса.\
\n\nВы оглядываете класс. Ваши товарищи выглядят не лучше: \
\nкто-то пытается подавлять зевоту, кто-то уже спит, положив \
\nголову на парту. \nМожет, вам удастся незаметно вздремнуть? \
\n\n<БОРОТЬСЯ СО СНОМ: А> <СДАТЬСЯ: Б>')
    in_start_text = input().strip().upper()
    while True:
        if in_start_text == "А" or in_start_text == "Б":
            break
        elif in_start_text == "ИНВЕНТАРЬ":
            inv()
            in_start_text = input().strip().upper()
        elif in_start_text == "ПРАВИЛА":
            print(rules)
            in_start_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            in_start_text = input().strip().upper()
    if in_start_text == "А":
        resist()
    elif in_start_text == "Б":
        sleep_look()


def resist():
    print("\nВы встряхиваете головой и выпрямляетесь. Надолго ли это поможет? \
\n\n<НИЧЕГО НЕ ДЕЛАТЬ: А> <ВЫЙТИ ИЗ КЛАССА: Б>")
    resist_text = input().strip().upper()
    while True:
        if resist_text == "А" or resist_text == "Б":
            break
        elif resist_text == "ИНВЕНТАРЬ":
            inv()
            resist_text = input().strip().upper()
        elif resist_text == "ПРАВИЛА":
            print(rules)
            resist_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            resist_text = input().strip().upper()
    if resist_text == "Б":
        exit_class()
    elif resist_text == "А":
        sleep_look()


def exit_class():
    print("\n«Ямада-сенсей, могу я выйти?»\
\n\nВы выходите из класса, направляясь в туалет. \
\nСтоя перед зеркалом, вы долго плещете холодной водой себе в лицо. \
Кажется, полегчало…\
\n\nВы протягиваете руку к дверной ручке, собираясь уходить. \
\nВы обращаете внимание на замочную скважину, из которой торчит ключ. \
\nСтранно… вы не помните, чтобы скважина когда-то была здесь. \
\nДа и ключ выглядит очень необычно: большой, потемневший, с \
завитушками на кольце. \nТакой можно будет выгодно обменять…\
\n\n<ОСТАВИТЬ КЛЮЧ: А> <ВЗЯТЬ КЛЮЧ: Б>")
    exit_class_text = input().strip().upper()
    while True:
        if exit_class_text == "А" or exit_class_text == "Б":
            break
        elif exit_class_text == "ИНВЕНТАРЬ":
            inv()
            exit_class_text = input().strip().upper()
        elif exit_class_text == "ПРАВИЛА":
            print(rules)
            exit_class_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            exit_class_text = input().strip().upper()
    if exit_class_text == "Б":
        inventory.append("КЛЮЧ ОТ ТУАЛЕТА")
        print("\nВы поспешно суете ключ в карман и возвращаетесь в класс.")
        sleep_look()
    elif exit_class_text == "А":
        print("\nВы возвращаетесь в класс.")
        sleep_look()


def sleep_look():
    print("\nСпустя несколько минут вы снова начинаете клевать носом. \
\nЗа окном сонно жужжит улица. \
Слова учителя доносятся словно откуда-то издалека…\
\n\nВы просыпаетесь от необычной тишины. \
Потирая лицо, вы поднимаете голову с парты.\
\n\n<ОСМОТРЕТЬСЯ: А>")
    sleep_look_text = input().strip().upper()
    while True:
        if sleep_look_text == "А":
            break
        if sleep_look_text == "ИНВЕНТАРЬ":
            inv()
            sleep_look_text = input().strip().upper()
        elif sleep_look_text == "ПРАВИЛА":
            print(rules)
            sleep_look_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            sleep_look_text = input().strip().upper()
    if sleep_look_text == "А":
        look_around()


def look_around():
    print("\nС ужасом вы обнаруживаете, что находитесь в классе одни. \
За окнами абсолютно темно, \
\nне видно даже фонарей вдоль улицы, что очень необычно. \
\nЕдинственное, что нарушает давящую тишину – \
потрескивание лампы над вашей головой. \
\nНе веря своим глазам, вы вскакиваете с места.\
\n\n«Как долго я… Сколько времени?»\
\n\nВы смотрите на электронные часы на стене.\
\n\n«4:44»\
\n\n«Неужели прошел день? Не может быть… Почему меня никто не разбудил?..»\
\n\nПошарив в своей сумке, вы достаете телефон, но он не включается.\
\n\n«Черт… зарядка! Мама меня убьет…»\
\n\nСлабыми после долгого сна руками вы хватаете сумку и бросаетесь к двери.\
\n\n<ОТКРЫТЬ ДВЕРЬ: А>")
    look_around_text = input().strip().upper()
    while True:
        if look_around_text == "А":
            break
        if look_around_text == "ИНВЕНТАРЬ":
            inv()
            look_around_text = input().strip().upper()
        elif look_around_text == "ПРАВИЛА":
            print(rules)
            look_around_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            look_around_text = input().strip().upper()
    if look_around_text == "А":
        open_door()


def open_door():
    print("\nВы несколько раз дергаете за ручку. Заперто. \
\n\n«Это что, какая-то шутка?! Не смешно! Откройте!» \
\n\nВ полном недоумении вы смотрите на дверь, нажимаете снова, \
наваливаясь плечом. \nДверь не поддается. Холодея, вы принимаетесь \
судорожно дергать ручку и колотить по двери.\
\nНет ответа. \
\nВы отходите от двери, пытаясь решить, что же делать дальше.\
\n\n<ОБЫСКАТЬ КЛАСС: А> <ПОСМОТРЕТЬ В ОКНО: Б> <ЖДАТЬ ДО УТРА: В>")
    open_door_text = input().strip().upper()
    while True:
        if (open_door_text == "А" or open_door_text == "Б" or
                open_door_text == "В"):
            break
        elif open_door_text == "ИНВЕНТАРЬ":
            inv()
            open_door_text = input().strip().upper()
        elif open_door_text == "ПРАВИЛА":
            print(rules)
            open_door_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            open_door_text = input().strip().upper()
    if open_door_text == "А":
        search_class()
    elif open_door_text == "Б":
        open_window()
    elif open_door_text == "В":
        boring_ending()


def boring_ending():
    print("\n«Уже почти утро… можно дождаться, когда все вернутся.»\
\n\nВы вздыхаете и смотрите на часы.\
\n\n«4:44»\
\n\n«Или не утро… с часами точно что-то не так. \
В любом случае, уйти я не могу.»\
\n\nВы возвращаетесь за свою парту и откидываетесь на стуле.\
\nРазмышляя о том, что сказать утром родителям,\
вы то и дело смотрите на часы. \
\nСпустя некоторое время вы снова засыпаете.\
\n\nНашедший вас утром учитель был весьма удивлен, \
но за ночь не случилось ровным счетом ничего необычного.")
    endings.add("СКУЧНАЯ КОНЦОВКА")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tСКУЧНАЯ КОНЦОВКА\
\n\n\t\t\t\t«никаких приключений»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def open_window():
    print("\nВы подходите к окну и прислоняете руки к лицу, \
\nпытаясь разглядеть что-нибудь на улице, \
\nно не видите абсолютно ничего, \
\nсловно кто-то заклеил стекло плотной бумагой. \
\nОкна в этом классе не открываются. \
\nВы продолжаете вглядываться в темноту. \
\nВдруг краем глаза вы замечаете \nкакое-то светлое пятно на стекле. \
\nЧто-то на улице? Или…\
\n\n<ОБЕРНУТЬСЯ: А> <НЕ ДВИГАТЬСЯ: Б>")
    open_window_text = input().strip().upper()
    while True:
        if open_window_text == "А" or open_window_text == "Б":
            break
        elif open_window_text == "ИНВЕНТАРЬ":
            inv()
            open_window_text = input().strip().upper()
        elif open_window_text == "ПРАВИЛА":
            print(rules)
            open_window_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            open_window_text = input().strip().upper()
    if open_window_text == "А":
        turn_around()
    elif open_window_text == "Б":
        bad_ending_1()


def bad_ending_1():
    print("\nВы замираете, вглядываясь в пятно. \
\nСпустя несколько секунд пятно начинает двигаться, \
ползти и вытягиваться. \
\nПохоже, кто-то бродит на улице… но вы не уверены до конца. \
\nВы хотите поднять руку, чтобы постучать по стеклу, \
\nно вдруг чувствуете, что не можете сдвинуться с места. \
\nВаши глаза прикованы к пятну, и вы в ужасе понимаете, \
\nчто оно – человеческая фигура, находящаяся позади вас. \
\nЕе очертания сильно размыты, но она определенно приближается. \
\nВаше сердце колотится невероятно быстро, \
широко открытыми глазами вы следите за отражением. \
\nФигура все четче вырисовывается: вы видите тонкие руки, \
длинные темные волосы...\
\nПрямо над своим ухом вы слышите тихий шепот, словно шелест: \
\n\n«Выпусти… меня…» \
\n\nКак будто во сне, вы не можете кричать и шевелиться. \
\n\n«Меня заставили… помоги… мне…» \
\n\nВы чувствуете холод на своей спине, и внезапно вокруг все темнеет. \
\nПоследнее, что вы видите в отражении, – бледное женское лицо \
\nпочти что прислоненное к вашему.")
    endings.add("ПЛОХАЯ КОНЦОВКА 1")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tПЛОХАЯ КОНЦОВКА 1\
\n\n\t\t\t\t«отражения»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def turn_around():
    print("\nВы резко оборачиваетесь. \
В классе все так же пусто. Но вы определенно что-то видели…\
\nВам становится сильно не по себе. \
Вы возвращаетесь к двери, \nчтобы попробовать снова открыть ее, \
но ваши попытки безрезультатны.\
\n\n<ЖДАТЬ ДО УТРА: А> <ОБЫСКАТЬ КЛАСС: Б>")
    turn_around_text = input().strip().upper()
    while True:
        if turn_around_text == "А" or turn_around_text == "Б":
            break
        elif turn_around_text == "ИНВЕНТАРЬ":
            inv()
            turn_around_text = input().strip().upper()
        elif turn_around_text == "ПРАВИЛА":
            print(rules)
            turn_around_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            turn_around_text = input().strip().upper()
    if turn_around_text == "Б":
        search_class()
    elif turn_around_text == "А":
        boring_ending()


def search_class():
    print("\nНе желая ждать, вы решаете осмотреть класс. \
\nВозможно, вам удастся найти копию ключа, которым вас тут заперли...\
\nНо с чего начать?\
\n\n<ПОСМОТРЕТЬ В ШКАФУ: А> <ПОИСКАТЬ НА СТОЛЕ: Б>")
    search_class_text = input().strip().upper()
    while True:
        if search_class_text == "А" or search_class_text == "Б":
            break
        elif search_class_text == "ИНВЕНТАРЬ":
            inv()
            search_class_text = input().strip().upper()
        elif search_class_text == "ПРАВИЛА":
            print(rules)
            search_class_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            search_class_text = input().strip().upper()
    if search_class_text == "А":
        look_note()
    elif search_class_text == "Б":
        look_table()


def look_table_w():
    print("\nВы подходите к столу учителя и начинаете \
перерывать все стопки бумаг и ящики. \
\nСреди книг и тетрадей вы замечаете яркий брелок. \
\nКажется, это ключ от класса!\
\n\n<УЙТИ: А>")
    inventory.append("КЛЮЧ ОТ КЛАССА")
    look_table_text_w = input().strip().upper()
    while True:
        if look_table_text_w == "А":
            break
        elif look_table_text_w == "ИНВЕНТАРЬ":
            inv()
            look_table_text_w = input().strip().upper()
        elif look_table_text_w == "ПРАВИЛА":
            print(rules)
            look_table_text_w = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            look_table_text_w = input().strip().upper()
    if look_table_text_w == "А":
        leave_class()


def look_note_w():
    print("\nВы открываете шкаф. В шкафу нет ничего, кроме книг. \
Собираясь закрыть его, \nвы замечаете стикер, приклеенный к створке внутри.\
\n\n«Отнести новый код в кабинет 42А»\
\n\nКод… почему-то вам кажется это важным. \
Вы срываете стикер с дверцы и убираете в карман. \
\n\n<УЙТИ: А>")
    inventory.append("СТИКЕР 42А")
    look_note_text_w = input().strip().upper()
    while True:
        if look_note_text_w == "А":
            break
        if look_note_text_w == "ИНВЕНТАРЬ":
            inv()
            look_note_text_w = input().strip().upper()
        elif look_note_text_w == "ПРАВИЛА":
            print(rules)
            look_note_text_w = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            look_note_text_w = input().strip().upper()
    if look_note_text_w == "А":
        leave_class()


def look_note():
    print("\nВы открываете шкаф. В шкафу нет ничего, кроме книг. \
Собираясь закрыть его, \nвы замечаете стикер, приклеенный к створке внутри.\
\n\n«Отнести новый код в кабинет 42А»\
\n\nКод… почему-то вам кажется это важным. \
Вы срываете стикер с дверцы и убираете в карман.\
\n\n<ПОИСКАТЬ НА СТОЛЕ: А>")
    inventory.append("СТИКЕР 42А")
    look_note_text = input().strip().upper()
    while True:
        if look_note_text == "А":
            break
        if look_note_text == "ИНВЕНТАРЬ":
            inv()
            look_note_text = input().strip().upper()
        elif look_note_text == "ПРАВИЛА":
            print(rules)
            look_note_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            look_note_text = input().strip().upper()
    if look_note_text == "А":
        look_table_w()


def look_table():
    print("\nВы подходите к столу учителя и начинаете \
перерывать все стопки бумаг и ящики. \
\nСреди книг и тетрадей вы замечаете яркий брелок. \
\nКажется, это ключ от класса!\
\n\n<УЙТИ: А> <ПОСМОТРЕТЬ В ШКАФУ: Б>")
    inventory.append("КЛЮЧ ОТ КЛАССА")
    look_table_text = input().strip().upper()
    while True:
        if look_table_text == "А" or look_table_text == "Б":
            break
        elif look_table_text == "ИНВЕНТАРЬ":
            inv()
            look_table_text = input().strip().upper()
        elif look_table_text == "ПРАВИЛА":
            print(rules)
            look_table_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            look_table_text = input().strip().upper()
    if look_table_text == "А":
        leave_class()
    elif look_table_text == "Б":
        look_note_w()


def leave_class():
    print("\nВы отпираете класс и выходите в коридор. \
В коридоре горит свет и стоит тишина. \
\nОглядевшись, вы направляетесь к лестнице на первый этаж. \
\nПоворачивая за угол, вы слышите тихие шаги за своей \
спиной и резко оборачиваетесь. \
\n\n«Кто здесь?»\
\n\nНет ответа. Поправив сумку на плече, вы ускоряете шаг. \
\nСпустившись, вы подходите к двери на улицу. \
\nВлажными от тревоги руками дергаете дверь. Конечно, она заперта.\
\n\n«Черт!.. Похоже, мне действительно придется ждать до утра.»\
\n\nСтиснув зубы, вы отходите от двери. Что делать дальше?\
\n\n<ПОПРОБОВАТЬ НАЙТИ КЛЮЧ: А>  <ЖДАТЬ: Б>")
    inventory.remove("КЛЮЧ ОТ КЛАССА")
    leave_class_text = input().strip().upper()
    while True:
        if leave_class_text == "А" or leave_class_text == "Б":
            break
        elif leave_class_text == "ИНВЕНТАРЬ":
            inv()
            leave_class_text = input().strip().upper()
        elif leave_class_text == "ПРАВИЛА":
            print(rules)
            leave_class_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            leave_class_text = input().strip().upper()
    if leave_class_text == "А":
        find_key()
    elif leave_class_text == "Б":
        print("\n«Не буду же я искать ключи по всей школе...»\
\n\nВы решаете вернуться в класс.\n")
        boring_ending()


def find_key():
    print("\n«Где они могут храниться?»\
\n\n<ВВЕДИТЕ НОМЕР КОМНАТЫ>")
    find_key_text = input().strip().upper()
    while True:
        if find_key_text == "42А" and ("СТИКЕР 42А") in inventory:
            break
        elif find_key_text == "ИНВЕНТАРЬ":
            inv()
            find_key_text = input().strip().upper()
        elif find_key_text == "ПРАВИЛА":
            print(rules)
            find_key_text = input().strip().upper()
        else:
            bad_ending_2()
    if find_key_text == "42А":
        go_room()


def bad_ending_2():
    print("\nНе представляя, где искать ключи, \
вы бездумно отправляетесь бродить по школе. \
\nВам сильно не по себе, и вы то и дело проверяете часы, \
заходя в открытые классы. \
\nОднако не одни из них не идут, показывая одно и то же время – «4:44». \
\nВы не знаете, сколько времени уже провели здесь. \
\nКазалось, уже целую вечность, но за окнами все так же темно. \
\nВы чувствуете чье-то присутствие, то и дело вам кажется, \
что из одного из запертых кабинетов доносится смех. \
\nВы обречены провести вечность взаперти и в полном одиночестве. \
\nИли не в полном?")
    endings.add("ПЛОХАЯ КОНЦОВКА 2")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tПЛОХАЯ КОНЦОВКА 2\
\n\n\t\t\t\t«вечное изгнание»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def go_room():
    print("\nБыстрым шагом вы направляетесь в комнату 42А. \
\nУ вас есть смутное предчувствие, что там вы \
найдете что-то, что поможет вам выбраться. \
\nВы поднимаетесь на четвертый этаж, \
\nно издалека замечаете что-то странное возле двери \
одного из кабинетов. \
\nВы подходите ближе. \n\n«Что за черт… это кровь!» \
\n\nИз-под двери кабинета медленно вытекает большая лужа \
темно-бордовой крови. \
\nВ ужасе вы делаете шаг назад и замираете. \
\nВдруг вы слышите что-то из-за двери кабинета. \
\nПохоже на всхлипы ребенка… \nС колотящимся сердцем вы прислушиваетесь. \
\n\n«Эй!.. Кто там?» \n\nНет ответа, только тихие всхлипы. \
\n\n«Тебе нужна помощь?» \n\nВ ответ вы получаете абсолютную тишину. \
\nВ нерешительности вы мнетесь на месте. \
\n\n<ВОЙТИ В КАБИНЕТ: А> <ИДТИ ДАЛЬШЕ: Б>")
    go_room_text = input().strip().upper()
    while True:
        if go_room_text == "А" or go_room_text == "Б":
            break
        elif go_room_text == "ИНВЕНТАРЬ":
            inv()
            go_room_text = input().strip().upper()
        elif go_room_text == "ПРАВИЛА":
            print(rules)
            go_room_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            go_room_text = input().strip().upper()
    if go_room_text == "А":
        bad_ending_3()
    elif go_room_text == "Б":
        keep_going()


def bad_ending_3():
    print("\nВы медленно и осторожно открываете дверь и заходите внутрь. \
\nЗа ней не оказывается ничего, кроме привычного вам класса. \
\nНикого, кто мог бы плакать.\
\nВернувшись к двери, вы обнаруживаете, что крови больше нет. \
Неужели показалось?\
\nВ недоумении вы оглядываетесь по сторонам, \
\nкак вдруг чувствуете парализующую боль в груди. \
\nВы смотрите вниз, на свою грудь, и видите пронзившее ее лезвие ножа. \
\nИспустив тихий вздох, вы оседаете на пол. \
\nВсе вокруг медленно меркнет, вы чувствуете растекающуюся под вами кровь. \
\nПоследнее, что вы видите перед полной темнотой, - \
\nбледное женское лицо, склонившееся над вами.")
    endings.add("ПЛОХАЯ КОНЦОВКА 3")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tПЛОХАЯ КОНЦОВКА 3\
\n\n\t\t\t\t«добрый самаритянин»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def keep_going():
    print("\nВы долго стоите возле двери, с тревогой разглядывая лужу, \
\nно ваш страх берет верх. Вы не решаетесь открыть дверь. \
Может, это и к лучшему... \
\nВнимательно прислушиваясь, вы пятитесь прочь от \
кабинета, пока всхлипы не становятся неслышными. \
\nПытаясь унять подступающую тошноту, вы подходите к нужной вам двери. \
\n\n<ВОЙТИ В КАБИНЕТ 42А: А>")
    keep_going_text = input().strip().upper()
    while True:
        if keep_going_text == "А":
            break
        if keep_going_text == "ИНВЕНТАРЬ":
            inv()
            keep_going_text = input().strip().upper()
        elif keep_going_text == "ПРАВИЛА":
            print(rules)
            keep_going_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            keep_going_text = input().strip().upper()
    if keep_going_text == "А":
        enter_class()


def enter_class():
    print("\nВы осторожно приоткрываете дверь класса. \
Первым делом вы решаете осмотреть стол учителя. \
\nНа нем, как и было указано в записке, \
\nлежала бумажка, на которой было написано: \
\n\n«Новый код от сейфа с копиями ключей \
от всех кабинетов - 4529». \
\n\nВы испустили облегченный вздох, потому что \
помнили, где находился сейф: \
\nон был в кабинете директора, куда вас неоднократно вызывали. \
\nЕсли он не заперт, вам удасться попасть домой! \
\n\nВзяв бумажку, вы собирались было пойти в кабинет директора, \
как обратили внимание на доску. \
\nНа ней крупными кривыми буквами было написано:\
\n\n«А ты хорошо видишь в темноте?»\
\n\nВаше сердце заколотилось с новой силой. \
\n\n«Что это значит?..»\
\n\nПереборов желание забиться под стол и переждать там до утра, \
вы медленно двинулись к выходу из кабинета. \
\nОткрывая дверь, вы краем глаза заметили зажигалку, \
валявшуюся возле мусорного ведра. \
\nВы остановились, чтобы поднять ее. \
Как ни странно, в ней еще оставался бензин. \
\n\n<ВЗЯТЬ ЗАЖИГАЛКУ: А> <ОСТАВИТЬ И УЙТИ: Б>")
    inventory.remove("СТИКЕР 42А")
    inventory.append("4529")
    enter_class_text = input().strip().upper()
    while True:
        if enter_class_text == "А" or enter_class_text == "Б":
            break
        if enter_class_text == "ИНВЕНТАРЬ":
            inv()
            enter_class_text = input().strip().upper()
        elif enter_class_text == "ПРАВИЛА":
            print(rules)
            enter_class_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            enter_class_text = input().strip().upper()
    if enter_class_text == "А":
        inventory.append("ЗАЖИГАЛКА")
        go_dean()
    if enter_class_text == "Б":
        go_dean()


def go_dean():
    print("\nВыскочив из кабинета, вы бегом спускаетесь \
на первый этаж, где находится кабинет директора. \
\nВыбегая с лестницы, вы попадаете в длинный коридор, \
идущий через весь этаж. \
\nОсмотревшись, в самом его конце вы замечаете \
какую-то фигуру женщины, стоящей к вам спиной. \
\nМожет, кто-то из учителей? Вы решаетесь окликнуть. \
\n\n«Эй! Извините!...» \
\n\nФигура медленно оборачивается и начинает быстро приближаться. \
\nНесколько секунд вы стоите неподвижно, \
стараясь разглядеть лицо человека...\
\n\n«У нее... нет ног?!»\
\n\nВаше сердце пропустило удар, а затем забилось с \
удвоенной скоростью.\
\nФигура в белом платье с длинными черными \
волосами парила над самой землей, \
\nпротягивая к вам руки... \
\n\n<СПРЯТАТЬСЯ В ТУАЛЕТЕ: А> <СПРЯТАТЬСЯ В ПОДВАЛЕ: Б> <БЕЖАТЬ: В>")
    go_dean_text = input().strip().upper()
    while True:
        if go_dean_text == "А" or go_dean_text == "Б" or go_dean_text == "В":
            break
        if go_dean_text == "ИНВЕНТАРЬ":
            inv()
            go_dean_text = input().strip().upper()
        elif go_dean_text == "ПРАВИЛА":
            print(rules)
            go_dean_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            go_dean_text = input().strip().upper()
    if go_dean_text == "А":
        go_bath()
    elif go_dean_text == "Б":
        go_base()
    elif go_dean_text == "В":
        bad_ending_4()


def bad_ending_4():
    print("\nВскрикнув от ужаса, вы бросаетесь бежать \
обратно по лестнице. \
\nВ секунды вы взлетаете на четвертый этаж, выбегаете в коридор \
и добегаете до его конца. \
\nОборачиваясь, вы видите фигуру в другом конце коридора, \
парящую абсолютно неподвижно.\
\nВдруг слышится громкий щелчок, и свет гаснет. \
\nВжавшись в стену, вы отчаянно вглядываетесь в темноту... \
Свет зажигается снова, но женщины больше не видно. \
\nСтараясь не дышать, вы стоите неподвижно. \
\nВдруг в одну секунду женщина оказывается прямо перед вашим лицом. \
\nНе способные пошевелиться, вы смотрите в ее кроваво-красные глаза. \
\n\n«Я только хотела поиграть с ними... но они меня не любили. \
Ты же будешь играть со мной?» \
\n\nОна протягивает руки к вашему лицу. Вы не можете кричать. \
\nСловно со стороны вы слышите, как в вашей глотке булькает кровь. \
\nВсе вокруг темнеет.")
    endings.add("ПЛОХАЯ КОНЦОВКА 4")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tПЛОХАЯ КОНЦОВКА 4\
\n\n\t\t\t\t«недостаточно быстро»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def go_bath():
    print("\nВы вбегаете в туалет и с силой захлопываете дверь. \
\nСнаружи все тихо. Несколько минут вы стоите, \
держа дверную ручку и дрожа. \
\n\nВдруг вы подскакиваете от неожиданно громкого звука позади вас. \
\nКраны каждой раковины сами по себе открылись на полную, \
и из них льется горячая вода, \
\nкоторая, почему-то, не уходит в слив. \
\nБуквально через пару секунд вода переливается через края раковин, \
\nи туалет начинает заполняться паром.\
\nВы бросаетесь закрывать краны, но не можете закрутить их. \
\nГорячая вода быстро прибывает, и вы вынуждены забраться \
на подоконник с ногами. \
\n\n<ОТКРЫТЬ ДВЕРЬ: А>")
    go_bath_text = input().strip().upper()
    while True:
        if go_bath_text == "А" or go_bath_text == "Б":
            break
        elif go_bath_text == "ИНВЕНТАРЬ":
            inv()
            go_bath_text = input().strip().upper()
        elif go_bath_text == "ПРАВИЛА":
            print(rules)
            go_bath_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            go_bath_text = input().strip().upper()
    if go_bath_text == "А":
        if "КЛЮЧ ОТ ТУАЛЕТА" in inventory:
            neutral_ending_1()
        else:
            neutral_ending_2()


def neutral_ending_2():
    print("\nСидя на подоконнике, вы изо всех сил пинаете дверь, \
чтобы выбраться из туалета, но она не поддается. \
\nКомната постепенно заполняется паром. \
\nВода прибывает неестественно быстро, и уже меньше, \
\nчем через две минуты, она достигает уровня подоконника. \
\nСтановится сложно видеть и дышать... \
Положив свою сумку под ноги, \
вы пытаетесь открыть решетку, закрывающую окно, \
но она намертво приварена. \
\nКипяток уже жжет ваши ноги. \
Вы карабкаетесь на решетку, но вода подступает все ближе...\
\n\n\nВы просыпаетесь на полу в своем классе. \
Над вами стоят озабоченные однокласники, \
\nгде-то справа слышен голос учителя. \
\n\n«Он очнулся! Тадаши, ты потерял сознание от жары, не \
вставай пока...» \n\nЧто... это было?.. Вы чувствуете тошносту и слабость. \
Это все - просто галлюцинация?.. \
\nДаже если так, вы больше никогда не сможете спать спокойно.")
    endings.add("НЕЙТРАЛЬНАЯ КОНЦОВКА 2")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tНЕЙТРАЛЬНАЯ КОНЦОВКА 2\
\n\n\t\t\t\t«перегрев»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def neutral_ending_1():
    print("\nСтоя по щиколотку в обжигающей воде, \
\nвы достаете из кармана ключ, который вы взяли \
из туалета на втором этаже. \
\nДрожащими руками вы резко вставляете его в скважину, \
и дверь поддается. \
\n\n«Слава богу, подошел!..» \
\n\nВы выскакиваете из туалета. \
\nПрямо рядом с ним находится окно, которое, на счастье, открыто. \
\nВы боитесь спускаться, и боясь, что то, что вы видели, \
вернется, решаете прыгать. \
\nНа первом этаже окна находятся низко, поэтому вы легко \
приземляетесь на ноги \
\nи стремглав бежите через пустой школьный двор. \
\nВсю дорогу до дома вы бежите, даже не глядя по сторонам. \
\nВзлетев на свой этаж, вы отпираете дверь своей квартиры и \
захлопываете за собой дверь. \
\nЗайдя в свою комнату, вы смотрите на часы. \
\n\n«4:44» \n\nВ ужасе вы вбегаете в спальню родителей, \
но не обнаруживаете никого. \
\nВыскочив из квартиры, вы начинаете исступленно стучать \
в двери соседей. Нет ответа. \
\nВы выбегаете на улицу. Никого. Только темнота. \
\nВы в безопасности. Никто вам не угрожает. Утро не наступит.")
    endings.add("НЕЙТРАЛЬНАЯ КОНЦОВКА 1")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tНЕЙТРАЛЬНАЯ КОНЦОВКА 1\
\n\n\t\t\t\t«пустота»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def go_base():
    print("\nСправа от вас находится дверь, ведущая в подвал. \
\nНе долго думая, вы дергаете за ручку и захлопываете ее за собой. \
\nВас окутывает кромешная тьма. \
С колотящимся сердцем вы нащупываете задвижку и запираете дверь. \
\nВы все еще неуверены, что вы в безопасности, \
\nпоэтому вы наощупь спускаетесь вниз на несколько ступенек и \
стоите наготове, чтобы бежать. \
\n\nВам кажется, что прошло не меньше часа. \
\nВы немного пришли в себя и подошли к двери, \
чтобы послушать, что происходит снаружи. \
\nНесколько минут из-за двери не доносится ни звука, \
и вы решаетесь выйти.\
\n\n<ВЫЙТИ: А>")
    go_base_text = input().strip().upper()
    while True:
        if go_base_text == "А" or go_base_text == "Б":
            break
        elif go_base_text == "ИНВЕНТАРЬ":
            inv()
            go_base_text = input().strip().upper()
        elif go_base_text == "ПРАВИЛА":
            print(rules)
            go_base_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            go_base_text = input().strip().upper()
    if go_base_text == "А":
        if "ЗАЖИГАЛКА" in inventory:
            diary()
        else:
            bad_ending_5()


def bad_ending_5():
    print("\nЗадвижка открыта, но почему-то вы \
не можете открыть дверь. \
\nНаощупь вы спускаетесь вниз по лестнице, но там вас \
встречает еще одна запертая дверь. \
\nВ панике вы бежите обратно наверх, дергаете дверь... \
\nНекоторое время вы бродите от одной двери к другой, кричите, \
стучите, зовете на помощь... \
\nПрошло слишком много времени. За вами не вернутся. \
Вас не найдут. \
\n\nВы сдаетесь.")
    endings.add("ПЛОХАЯ КОНЦОВКА 5")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tПЛОХАЯ КОНЦОВКА 5 \
\n\n\t\t\t\t«тьма»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def diary():
    print('\nЗадвижка открыта, но почему-то \
вы не можете открыть дверь. \
\nЕдинственное, что вам остается - спуститься вниз по лестнице. \
\nПри свете зажигалки вы добираетесь до подвального помещения, \
влажного и неприятно пахнущего. \
\nОно небольшое, и зажигалка освещает его полностью. \
\nПо стенам его стоят полки с какими-то коробками, \
несколько сломанных стульев и прочий хлам. \
\nВы осматриваете все вокруг себя, в надежде найти что-то полезное. \
\nНе найдя ничего, вы садитесь на пол. \
\nПод одним из стеллажей на полу вы замечаете \
небольшой розовый предмет. \
Вы подходите и берете его в руки. \
\nВещь оказывается блокнотом. Без особого интереса вы \
пролистываете его, но обнаруживаете, что все \
\nстраницы, кроме нескольких последних, \
вымазаны чем-то... похоже на кровь. \
\n\nВы читаете:\
\n\n«Сегодня был первый день в новой школе. \
Я еще не познакомилась ни с кем. \
\nОни все почему-то смотрели на меня странно... \
словно со мной что-то не так. \
\nМне страшно с ними знакомиться, мама сказала, \
что мне нельзя сильно волноваться. \
\nНадеюсь, кто-нибудь захочет со мной дружить...»\
\n«Кодзима дернул меня за косичку. \
Может, он хочет дружить? \
Я хотела что-нибудь ему сказать, но не смогла...» \
\n«Я поздоровалась с Айко сегодня, она казалась мне милой. \
\nОна посмотрела на меня, но не поздоровалась. \
Я что-то делаю неправильно?» \
\n«Я слышала, как Хаято рассказывал историю про монстра, \
который живет в школьном подвале. \
\nПохоже, он хочет пробраться туда... \
Может, если я тоже пойду, он меня заметит?.. \
\nЯ смелая. Я не верю в монстров.» \
\n\nНа этом записи закончились. \
Вдруг вы вспомнили историю, \
\nкоторую кто-то рассказывал вам давным-давно... \
\n\nНеужели... Это она? Не может быть! \
\n\nПовертев дневник в руках, \
на обложке вы находите имя владелицы. \
\n\n<ОСТАВИТЬ ДНЕВНИК: А> <ВЗЯТЬ: Б>')
    diary_text = input().strip().upper()
    while True:
        if diary_text == "А" or diary_text == "Б":
            break
        if diary_text == "ИНВЕНТАРЬ":
            inv()
            diary_text = input().strip().upper()
        elif diary_text == "ПРАВИЛА":
            print(rules)
            diary_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            diary_text = input().strip().upper()
    if diary_text == "Б":
        inventory.append("ДНЕВНИК ХИДЕКО НАГАИ")
        dean()
    if diary_text == "А":
        dean()


def dean():
    print("\nВы поднимаетесь по лестнице, \
чтобы снова проверить дверь, \
и видите, что она открыта. \
\nОсторожно высунув голову и осмотревшись, \
вы спешите в кабинет директора, \
\nкоторый находится совсем рядом. На счастье, он открыт. Вот и сейф...\
\n\n<ВВЕДИТЕ КОД>")
    dean_text = input().strip().upper()
    while True:
        if dean_text == "4529":
            break
        if dean_text == "ИНВЕНТАРЬ":
            inv()
            dean_text = input().strip().upper()
        elif dean_text == "ПРАВИЛА":
            print(rules)
            dean_text = input().strip().upper()
        else:
            print("\nНеверный код")
            dean_text = input().strip().upper()
    if dean_text == "4529":
        if ("ДНЕВНИК ХИДЕКО НАГАИ") in inventory:
            inventory.remove("4529")
            face()
        else:
            inventory.remove("4529")
            good_ending()


def good_ending():
    print("\nВы слышите звуковой сигнал и \
облегченно вздыхаете, когда дверца открывается. \
\nСхватив связку ключей, вы спешите к выходу. \
\nОтперев дверь, вы стремглав выбегаете во двор и \
ни разу не останавливаетесь до самого дома. \
\n\nПридя домой, вы тихо пробираетесь к себе в комнату. \
\nНа часах около полуночи, и вы ложитесь в кровать, \
но долго не можете заснуть. \
\n\n«Но Исаму сказал, что ты у него!.. Как ты это объяснишь?» \
\nНа выговор от родителей вы не обращаете внимания. \
\t\tЧестно говоря, вы бы и сами хотели знать, как.")
    endings.add("ХОРОШАЯ КОНЦОВКА")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tХОРОШАЯ КОНЦОВКА\
\n\n\t\t\t\t«побег»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


def face():
    print("\nПока вы вводите код дрожащими руками, \
вы слышите голос за своей спиной: \
\n«Ты знаешь... мое имя? Со мной давно \
никто не говорил, я... забыла.» \
\nХолодея, вы медленно разворачиваетесь и видите перед \
собой девочку лет тринадцати в школьной форме, \
\nбледную и растерянную. \
\n\n«Это... это была ты?» \
\n\nДевочка виновато кивает головой в ответ. \
В вашей голове все вдруг встает на свои места. \
\n\n<НАЗОВИТЕ ИМЯ>")
    face_text = input().strip().upper()
    while True:
        if face_text == "ХИДЕКО НАГАИ":
            break
        if face_text == "ИНВЕНТАРЬ":
            inv()
            face_text = input().strip().upper()
        elif face_text == "ПРАВИЛА":
            print(rules)
            face_text = input().strip().upper()
        else:
            print("\nТакой опции нет.")
            face_text = input().strip().upper()
    if face_text == "ХИДЕКО НАГАИ":
        true_ending()


def true_ending():
    print("\n«Хидеко... Тебя зовут Хидеко Нагаи. \
Твои одноклассники заперли тебя в подвале в этой школе. \
\nУ тебя были проблемы с сердцем... \
Это было семнадцать лет назад.» \
\n\nДевочка медленно качнула головой. \
\n\n«Хидеко...» \
\nВы стояли неподвижно, не способные \
отвести взгляд от мертвенно-бледного лица. \
\n«А ты... будешь моим другом?» \
\nГлядя в грустные широко раскрытые глаза \
Хидеко, вы неуверенно киваете. \
\n«Да... да, я буду твоим другом.» \
Лицо девочки прояснилось и озарилось счастливой улыбкой. \
\n«Спасибо.» \
\nДевочка низко поклонилась вам. Повернувшись, \
она плавно пошла к двери и, \
\nне успев перешагнуть через порог, растаяла в воздухе. \
\n\nНесколько секунд вы стояли в кабинете одни, \
в полной тишине, как вдруг все наполнилось звуками, \
\nи по глазам вам ударил яркий свет. Вы оказались посреди коридора, \
\nокруженные толпой школьников, бегущих в столовую. \
\nВы растерянно оглядывались по сторонам, \
но перед глазами у вас все еще стояло ее лицо. \
\n\n«Хидеко. Теперь она свободна...»\
\n\nНесколько минут вы оставались на месте, \
глядя в сторону подвальной двери. \
\nЗатем, вздохнув и поправив на плече сумку, \
вы последовали в столовую за своими товарищами.")
    endings.add("НАСТОЯЩАЯ КОНЦОВКА")
    inventory.clear()
    print(f"\n\n\n\nСпасибо за игру! Вы открыли:\
\n\n\t\t\t\tНАСТОЯЩАЯ КОНЦОВКА \
\n\n\t\t\t\t«освобождение»\
\n\n\nВы открыли {len(endings)} из 10 концовок игры!")
    if len(endings) < 10:
        not_collect_all()
    if len(endings) == 10:
        collect_all()


start_new_game()
